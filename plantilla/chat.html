<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chat</title>
</head>
<body>
    <h2 id="room-title"></h2>
    <div id="chat-box"></div>
    <input type="text" id="message" placeholder="Escribe un mensaje...">
    <button onclick="sendMessage()">Enviar</button>

    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script>
        const socket = io("http://localhost:3000"); 

        const params = new URLSearchParams(window.location.search);
        const usuario = params.get("usuario");
        const sala = params.get("sala");

        document.getElementById("room-title").textContent = `Sala: ${sala}`;

        socket.emit("joinRoom", sala);

        socket.on("roomJoined", (msg) => {
            console.log(msg);
        });

        socket.on("receiveMessage", (data) => {
            const chatBox = document.getElementById("chat-box");
            const msgElement = document.createElement("p");
            msgElement.textContent = `${data.usuario}: ${data.mensaje}`;
            chatBox.appendChild(msgElement);
        });

        function sendMessage() {
            const messageInput = document.getElementById("message");
            const mensaje = messageInput.value;
            if (mensaje.trim() !== "") {
                socket.emit("sendMessage", { room: sala, usuario, mensaje });
                messageInput.value = "";
            }
        }
    </script>
</body>
</html>
